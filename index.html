<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nest AI</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="./css/output.css" rel="stylesheet">

    <script>
        // Define supported languages
        const supportedLanguages = ['en', 'it', 'es', 'de', 'fr'];

        // Get browser preferred languages
        const browserLanguages = navigator.languages ||
            [navigator.language ||
                navigator.userLanguage ||
                'en'];

        const userData = {};

        // Find the first browser language that matches our supported languages
        let matchedLanguage = null;

        // Loop through browser's preferred languages
        for (const browserLang of browserLanguages) {
            // Get the primary language code (e.g., 'en-US' -> 'en')
            const primaryLang = browserLang.split('-')[0].toLowerCase();

            // Check if we support this language
            if (supportedLanguages.includes(primaryLang)) {
                matchedLanguage = primaryLang;
                break;
            }
        }

        // Set the matched language or default to English
        userData.locale = matchedLanguage || 'en';
        console.log(`Detected browser language: ${userData.locale}`);
        document.querySelector('html').setAttribute('lang', userData.locale);

    </script>
</head>

<body class="">
    <!-- Chatbot Toggler -->
    <button id="chatbot-toggler">
        <span class="">
            <img class="chatbot-logo" src="./img/nest-chatbot_white.png" alt="Chatbot Logo" width="33" height="33">
        </span>
        <span class="">
            <img class="chatbot-logo" src="./img/nest-chatbot_white.png" alt="Chatbot Logo" width="33" height="33">
            <!-- <i class="fa-solid fa-times"></i> -->
        </span>
    </button>

    <div class="chatbot-popup">
        <!-- Chatbot Header -->
        <div class="chat-header">
            <div class="header-info">
                <div class="chatbot-logo">
                    <img class="" src="./img/Group 236.png" alt="Chatbot Logo" width="55" height="55">
                </div>

                <div class="flex flex-col ml-2">
                    <h2 class="logo-text">GermÃ¡n</h2>
                    <h6 class="text-secondary">Nests Hostels AI assistan</h6>
                </div>
            </div>

            <button id="close-chatbot" class="">
                <i class="fa-solid fa-minus"></i>
            </button>
        </div>

        <!-- Chatbot Body -->
        <div class="chat-body">
            <div class="message bot-message" id="firstBotMessage">
                <img class="bot-avatar" src="./img/Ibiza-a21caf.png" alt="Chatbot Logo" width="50" height="50" />
                <!-- prettier-ignore -->
                <div class="message-text">
                    Hey there ðŸ‘‹<br /> How can I help you today?
                </div>
            </div>

            <div class="chat-loader h-full flex justify-center items-center transition-all" id="chatLoader">
                <svg width="180" height="180" viewBox="0 0 180 180" class="circular-progress">
                    <circle class="bg" cx="90" cy="90" r="85"></circle>
                    <circle class="fg" cx="90" cy="90" r="85"></circle>
                </svg>
            </div>
        </div>

        <!-- Chatbot Footer -->
        <div class="chat-footer">
            <div class="chat-container">
                <div class="language-menu-container">
                    <button type="button" class="language-selector" id="language-toggle" data-lang="en">
                        <img src="https://flagsapi.com/GB/flat/64.png" class="flag-icon" alt="English" />
                    </button>
                    <div class="language-options">
                        <button class="language-option" data-lang="es">
                            <img src="https://flagsapi.com/ES/flat/64.png" class="flag-icon" alt="EspaÃ±ol" />
                            <span class="sr-only">EspaÃ±ol</span>
                        </button>
                        <button class="language-option hidden" data-lang="en">
                            <img src="https://flagsapi.com/GB/flat/64.png" class="flag-icon" alt="English" />
                            <span class="sr-only">English</span>
                        </button>
                        <button class="language-option" data-lang="it">
                            <img src="https://flagsapi.com/IT/flat/64.png" class="flag-icon" alt="Italiano" />
                            <span class="sr-only">Italiano</span>
                        </button>
                        <button class="language-option" data-lang="de">
                            <img src="https://flagsapi.com/DE/flat/64.png" class="flag-icon" alt="Deutsch" />
                            <span class="sr-only">Deutsch</span>
                        </button>
                        <button class="language-option" data-lang="fr">
                            <img src="https://flagsapi.com/FR/flat/64.png" class="flag-icon" alt="FranÃ§ais" />
                            <span class="sr-only">FranÃ§ais</span>
                        </button>
                    </div>
                </div>

                <form action="jsvascript:void(0);" class="chat-form">
                    <textarea placeholder="Message..." class="message-input" minlength="2" rows="1" required></textarea>

                    <div class="chat-controls">
                        <div class="file-upload-wrapper">
                            <input type="file" accept="image/*" id="file-input" hidden />
                            <img src="#" />
                            <button type="button" id="file-upload" class="">
                                <i class="fa-solid fa-archive"></i>
                            </button>
                            <button type="button" id="file-cancel" class="">
                                <i class="fa-solid fa-times"></i>
                            </button>
                        </div>

                        <button type="submit" id="send-message" class="">
                            <fa class="fa-solid fa-paper-plane"></fa>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Linking custom script -->
    <script type="module" src="./javascript/nest-chatbot.js"></script>
</body>

</html>